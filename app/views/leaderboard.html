<div class="content-header">

  <div class="container">
    <h1>Leaderboard</h1>
    <h2>{{ '_LEADERBOARD_SUBTITLE' | translate}}</h2>
  </div>

</div>

<div class="leaderboard-container container">
  <div class="heading">
    <div class="options">
      <button class="btn btn-default" ng-click="changeView('overall')" ng-class="{'btn-info': state.view == 'overall'}">
        <span ng-if="state.loading" class="glyphicon glyphicon-refresh spinner"></span> Overall
      </button>
      <button class="btn btn-default" ng-click="changeView('geldByNewMoon')" ng-class="{'btn-info': state.view == 'geldByNewMoon'}">
        <span ng-if="state.loading" class="glyphicon glyphicon-refresh spinner"></span> Geld by new moon
      </button>
    </div>
    <h1 class="page-title">{{ '_LEADERBOARD' | translate }}</h1>
  </div>

  <!-- Overall leaderboard -->
  <table class="table table-striped table-hover" ng-if="state.view == 'overall'">
    <thead>
      <tr>
        <th class="col-md-1 pointer" ng-click="setSort('player_alias')">{{ '_PLAYER' | translate }}</th>
        <th class="col-md-1 pointer" ng-click="setSort('claim_count', true)">{{ '_CLAIMS' | translate }}</th>
        <th class="col-md-1 pointer" ng-click="setSort('tower_count', true)">{{ '_TOWER_COUNT' | translate }}</th>
        <th class="col-md-1 pointer" ng-click="setSort('first_claimed_on')">{{ '_FIRST_CLAIM' | translate }}</th>
        <th class="col-md-1 pointer" ng-click="setSort('last_claimed_on')">{{ '_LAST_CLAIM' | translate }}</th>
        <th class="col-md-1 pointer" ng-click="setSort('geld_collected', true)">{{ '_GELD_COLLECTED' | translate }}</th>
        <th class="col-md-1 pointer" ng-click="setSort('geld_bonus', true)">{{ '_GELD_BONUS' | translate }}</th>
      </tr>
    </thead>

    <tbody>
      <tr data-ng-repeat="row in leaderboard | orderBy:orderBy:reverseOrder">
        <td>{{ row.player_alias || 'No alias' }}</td>
        <td>{{ row.claim_count }}</td>
        <td>{{ row.tower_count }}</td>
        <td>{{ row.first_claimed_on | date:'mediumDate' }}</td>
        <td>{{ row.last_claimed_on | date:'mediumDate' }}</td>
        <td>{{ row.geld_collected | number:0 }}</td>
        <td>{{ row.geld_bonus | number:0 }}</td>
      </tr>
    </tbody>

  </table>
  <!-- / Overall leaderboard -->

  <!-- New moon leaderboard -->
  <div ng-if="state.view == 'geldByNewMoon'">

    <label>Select new moon</label>
    <select class="form-control" ng-options="o.iso8601 | date for o in newMoons" ng-model="$parent.selectedNewMoon" ng-change="selectNewMoon()"></select>

    <hr>

    <h3 ng-if="leaderboard.length">Leaderboard for {{ selectedNewMoon.iso8601 | date }}</h3>
    <table class="table table-striped table-hover" ng-if="leaderboard.length">
      <thead>
        <tr>
          <th class="col-md-2">Place</th>
          <th class="col-md-4">{{ '_PLAYER' | translate}}</th>
          <th class="col-md-6">Geld</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <tr data-ng-repeat="row in leaderboard">
          <td ng-class="{bold: row.place <= 3}">
            {{ row.place }}
          </td>
          <td>
            <strong>{{ row.player_alias || 'No alias' }}</strong>
          </td>
          <td>{{ row.geld | number:0}}</td>
          <td>
            <medal place="row.place" ng-if="row.place <= 3"></medal>
          </td>
        </tr>
      </tbody>

    </table>
  </div>
  <!-- / New moon leaderboard -->

</div>
